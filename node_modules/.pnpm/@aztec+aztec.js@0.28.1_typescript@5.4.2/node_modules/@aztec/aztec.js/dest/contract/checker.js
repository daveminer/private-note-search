/**
 * Validates the given ContractArtifact object by checking its functions and their parameters.
 * Ensures that the ABI has at least one function, a constructor, valid bytecode, and correct parameter types.
 * Throws an error if any inconsistency is detected during the validation process.
 *
 * @param artifact - The ContractArtifact object to be validated.
 * @returns A boolean value indicating whether the artifact is valid or not.
 */
export function abiChecker(artifact) {
    if (!artifact.functions || artifact.functions.length === 0) {
        throw new Error('artifact has no functions');
    }
    artifact.functions.forEach(func => {
        if (!('name' in func && typeof func.name === 'string' && func.name.length > 0)) {
            throw new Error('ABI function has no name');
        }
        // TODO: implement a better check for bytecode (right now only checks if it's > 0)
        if (!('bytecode' in func && typeof func.bytecode === 'string' && func.bytecode.length > 0)) {
            throw new Error('ABI function parameter has incorrect bytecode');
        }
        func.parameters.forEach(param => {
            if (!param.type) {
                throw new Error('ABI function parameter has no type');
            }
            abiParameterTypeChecker(param.type);
        });
    });
    // TODO: implement a better check for constructor (right now only checks if it has it or not)
    if (!artifact.functions.find(func => func.name === 'constructor')) {
        throw new Error('ABI has no constructor');
    }
    return true;
}
/**
 * Validates the ABI function parameter's type by checking its kind and attributes.
 * Throws an error if the type has an unrecognized kind or incorrectly formed attributes.
 * Additionally, checks nested types for array and struct kinds.
 *
 * @param type - The ABIType object representing the type of the ABI function parameter.
 * @returns A boolean value indicating whether the type is valid or not.
 */
function abiParameterTypeChecker(type) {
    switch (type.kind) {
        case 'field':
        case 'boolean':
            return checkAttributes(type, {});
        case 'integer':
            return checkAttributes(type, { sign: 'string', width: 'number' });
        case 'string':
            return checkAttributes(type, { length: 'number' });
        case 'array':
            return checkAttributes(type, { length: 'number', type: 'object' }) && abiParameterTypeChecker(type.type);
        case 'struct':
            return checkAttributes(type, { fields: 'object', path: 'string' }) && checkStruct(type);
        default:
            throw new Error('ABI function parameter has an unrecognized type');
    }
}
/**
 * Check if the structure of the ABIType 'struct' is valid by ensuring field names are strings
 * and their type attribute passes the abiParameterTypeChecker. Returns true on successful validation,
 * otherwise throws an error providing insight into the incorrect formation in the struct.
 *
 * @param type - The StructType object containing an array of fields to validate.
 * @returns A boolean value indicating successful validation of the struct's fields.
 */
function checkStruct(type) {
    return type.fields.reduce((acc, field) => {
        if (!('name' in field && typeof field.name === 'string')) {
            throw new Error('ABI function parameter has an incorrectly formed struct');
        }
        return acc && abiParameterTypeChecker(field.type);
    }, true);
}
/**
 * Check if a provided ABI type has the correct attributes and their associated types.
 * This function compares the given 'type' object's keys with the expected attribute types
 * specified in 'incompleteAttributes', as well as the required 'kind' property.
 * Throws an error if there are any unrecognized attributes or incorrect attribute types.
 *
 * @param type - The ABI type object to be checked for correct attributes.
 * @param incompleteAttributes - An object representing the expected attribute types without the 'kind' property.
 * @returns Returns true if the provided ABI type has the correct attributes and their associated types, otherwise throws an error.
 */
function checkAttributes(type, incompleteAttributes) {
    const typeKeys = Object.keys(type);
    const attributes = { ...incompleteAttributes, kind: 'string' };
    if (typeKeys.length !== Object.keys(attributes).length) {
        throw new Error(`Unrecognized attribute on type ${type.kind}`);
    }
    typeKeys.forEach(element => {
        if (!(element in type && typeof type[element] === attributes[element])) {
            throw new Error(`ABI function parameter has an incorrectly formed ${type.kind}`);
        }
    });
    return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb250cmFjdC9jaGVja2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVFBOzs7Ozs7O0dBT0c7QUFDSCxNQUFNLFVBQVUsVUFBVSxDQUFDLFFBQTBCO0lBQ25ELElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxJQUFJLFFBQVEsQ0FBQyxTQUFTLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQzNELE1BQU0sSUFBSSxLQUFLLENBQUMsMkJBQTJCLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQsUUFBUSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDaEMsSUFBSSxDQUFDLENBQUMsTUFBTSxJQUFJLElBQUksSUFBSSxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDL0UsTUFBTSxJQUFJLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQzlDLENBQUM7UUFFRCxrRkFBa0Y7UUFDbEYsSUFBSSxDQUFDLENBQUMsVUFBVSxJQUFJLElBQUksSUFBSSxPQUFPLElBQUksQ0FBQyxRQUFRLEtBQUssUUFBUSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDM0YsTUFBTSxJQUFJLEtBQUssQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO1FBQ25FLENBQUM7UUFFRCxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUM5QixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO2dCQUNoQixNQUFNLElBQUksS0FBSyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7WUFDeEQsQ0FBQztZQUVELHVCQUF1QixDQUFDLEtBQUssQ0FBQyxJQUFJLENB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